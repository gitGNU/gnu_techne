#!/bin/bash

prefix=@prefix@
exec_prefix=@exec_prefix@
libdir=@libdir@
datarootdir=@datarootdir@
datadir=@datadir@

# Run through the list of arguments given
# and extract the ones that should be handled
# at this point.

args=()
debug=0

for arg in "$@"; do
    if [ "$arg" = "--debug" ]; then
	debug=1
    elif [ "$arg" = "--trace" ]; then
	debug=1
	commands="set confirm off\nrun\nbt\n"
    else
	args+=("$arg")
    fi
done

if [ "$debug" -eq 1 -a -n "$commands" ]; then
    echo -e "$commands" | gdb -silent --args ${libdir}/techne/techne.bin -Oprefix=${datadir}/techne ${args[*]}
elif [ "$debug" -eq 1 ]; then
    gdb -silent --args ${libdir}/techne/techne.bin -Oprefix=${datadir}/techne ${args[*]}
else
    ${libdir}/techne/techne.bin -Oprefix=${datadir}/techne -Oprefix=${datadir}/techne/scripts "${args[@]}"
fi
